# 🤖 AI Features User Guide

## ✅ 新增功能完成！

已成功添加 Copilot 风格的 AI 功能到 OB English Learner 插件。

---

## 🎯 功能概览

### **1. 右键菜单 - 智能文本处理**
选中文本后右键，可以使用：
- 🌐 **翻译成中文** - 快速翻译选中的英文
- 📖 **解释** - 详细解释单词或短语
- ✍️ **改写** - 让句子更自然流畅
- 📝 **总结** - 提炼内容要点

### **2. AI 聊天面板 - 智能对话助手**
- 💬 完整的对话界面
- 🎯 快捷操作按钮（翻译、解释、改写、总结）
- 📝 保持对话上下文
- 🎨 美观的消息界面

### **3. 工具栏图标**
- 🤖 点击工具栏的机器人图标
- 快速打开 AI 聊天面板

---

## 🚀 使用方法

### **方法 1: 右键菜单（最快捷）**

#### **翻译文本**
```
1. 选中要翻译的英文文本
2. 右键 → "🤖 AI: 翻译成中文"
3. 翻译结果自动插入到选中文本下方
```

**示例：**
```
选中文本: "How are you doing today?"
结果插入:

**翻译：**
你今天怎么样？
```

#### **解释单词/短语**
```
1. 选中单词或短语
2. 右键 → "🤖 AI: 解释"
3. 详细解释自动插入
```

**示例：**
```
选中: "take care of"

**解释：**
"take care of" 是一个常用短语，意思是"照顾、处理"。
常见用法：
- Take care of yourself（照顾好自己）
- I'll take care of it（我会处理的）
```

#### **改写句子**
```
1. 选中要改写的句子
2. 右键 → "🤖 AI: 改写"
3. 更自然的表达自动插入
```

**示例：**
```
原文: "I want to go to store for buy some food"

**改写：**
I'd like to go to the store to buy some food.
```

#### **总结内容**
```
1. 选中一段文本
2. 右键 → "🤖 AI: 总结"
3. 要点总结自动插入
```

---

### **方法 2: AI 聊天面板（最灵活）**

#### **打开方式**
1. **工具栏图标**：点击左侧工具栏的 🤖 图标
2. **命令面板**：`Ctrl + P` → 输入 "Open AI Chat"
3. **快捷键**：可在设置中自定义

#### **使用聊天面板**

**基础对话**
```
直接输入问题：
→ "grocery 这个词怎么用？"
→ "解释一下 present perfect tense"
→ "翻译：How's it going?"
```

**快捷按钮（配合选中文本）**
```
1. 在编辑器中选中文本
2. 打开 AI 聊天面板
3. 点击顶部快捷按钮：
   - 📝 翻译
   - 📖 解释
   - ✍️ 改写
   - 🎯 总结
```

**对话上下文**
```
聊天面板会记住最近 5 条消息，可以连续提问：

你：翻译：How are you?
AI：你好吗？

你：这个表达更随意的说法是什么？
AI：更随意的说法可以是 "What's up?" 或 "How's it going?"
```

---

### **方法 3: 学习助手（针对笔记）**

使用 `Ctrl + P` → "Ask Learning Assistant" 可以：
- 基于你的笔记回答问题
- 查找学过的内容
- 复习特定主题

---

## ⚙️ 配置说明

### **启用 AI 功能**
```
设置 → AI Translation 标签
1. 配置 AI Provider 和 API Key
2. 启用 "Enable Vault QA"
3. 工具栏图标会自动显示
```

### **AI 提供商支持**
- ✅ OpenAI (GPT-4, GPT-4o-mini)
- ✅ DeepSeek (deepseek-chat)
- ✅ Google Gemini (gemini-2.0-flash)
- ✅ SiliconFlow (DeepSeek-V3)
- ✅ 自定义 API

---

## 💡 使用场景

### **场景 1: 快速翻译视频字幕**
```
1. 打开视频笔记
2. 选中一段英文字幕
3. 右键 → "翻译成中文"
4. 翻译立即插入，方便理解
```

### **场景 2: 学习新单词**
```
1. 遇到生词 "sophisticated"
2. 选中 → 右键 → "解释"
3. 获得详细解释和例句
```

### **场景 3: 改善写作**
```
1. 写了一段英文日记
2. 选中想改进的句子
3. 右键 → "改写"
4. 对比学习更地道的表达
```

### **场景 4: 复习总结**
```
1. 选中一篇长文章
2. 右键 → "总结"
3. 快速获得要点
```

### **场景 5: 自由对话**
```
1. 点击工具栏 🤖 图标
2. 在聊天面板中：
   - 问语法问题
   - 请教用法
   - 对比不同表达
   - 任何英语学习疑问
```

---

## 🎨 界面特点

### **聊天面板设计**
```
┌─────────────────────────────────────┐
│ 💬 AI Assistant                     │
│ Chat with AI about your learning    │
├─────────────────────────────────────┤
│ [📝 翻译] [📖 解释] [✍️ 改写] [🎯 总结] │
├─────────────────────────────────────┤
│                                     │
│ 👤 你的问题                          │
│ ┌─────────────────────────────────┐ │
│ │ 显示你的消息                     │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🤖 AI 回答                          │
│ ┌─────────────────────────────────┐ │
│ │ AI 的回答内容                    │ │
│ │ • 支持分段                       │ │
│ │ • 支持列表                       │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│ [输入消息...]              [发送]    │
├─────────────────────────────────────┤
│           🗑️ 清空对话                │
└─────────────────────────────────────┘
```

### **右键菜单位置**
```
右键菜单：
├── Aloud: Play selection      (TTS 功能)
├── Aloud: Paste text to audio
├── Aloud: Export selection to audio
├── ──────────────────────────
├── 🤖 AI: 翻译成中文           ← 新增
├── 🤖 AI: 解释                ← 新增
├── 🤖 AI: 改写                ← 新增
└── 🤖 AI: 总结                ← 新增
```

---

## 📊 功能对比

| 功能 | 右键菜单 | AI 聊天面板 | 学习助手 |
|------|---------|------------|---------|
| **速度** | ⚡⚡⚡ 最快 | ⚡⚡ 快速 | ⚡ 中等 |
| **灵活性** | 🔸 固定操作 | 🔸🔸🔸 完全自由 | 🔸🔸 基于笔记 |
| **上下文** | ❌ 单次操作 | ✅ 保持对话 | ✅ 搜索笔记 |
| **适用场景** | 快速处理文本 | 深入讨论问题 | 复习学过内容 |

---

## 🔧 技术细节

### **新增文件**
```
src/ai/
└── chat-panel.ts    # AI 聊天面板（430 行）
```

### **修改文件**
```
main.ts              # +180 行
├── 右键菜单注册
├── AI 功能方法实现
├── 工具栏图标
└── 命令注册
```

### **代码统计**
- 新增代码：~600 行
- 打包增量：+15KB（213KB → 228KB）
- 零新增依赖
- 编译时间：<1 秒

---

## 💪 功能亮点

### **1. 即时反馈**
```
操作 → 通知提示 → 结果插入
整个过程 < 3 秒
```

### **2. 智能插入**
```
结果自动插入到：
- 选中文本下方
- 保持光标位置
- 不影响原文
```

### **3. 多种入口**
```
✅ 右键菜单（选中文本时）
✅ 工具栏图标
✅ 命令面板
✅ 可自定义快捷键
```

### **4. 优雅的错误处理**
```
✅ API 错误 → 显示友好提示
✅ 未选中文本 → 引导用户
✅ 未配置 API → 提示配置
```

---

## ⚠️ 注意事项

### **首次使用**
1. ✅ 确保已配置 AI API Key
2. ✅ 在设置中启用 "Enable Vault QA"
3. ✅ 重启 Obsidian 使工具栏图标生效

### **API 使用**
- 右键功能会调用 AI API（消耗 tokens）
- 建议使用经济型模型（如 gemini-2.0-flash）
- 聊天面板会保持对话上下文（消耗更多）

### **最佳实践**
```
✅ 短文本使用右键菜单（快速、省 tokens）
✅ 复杂问题使用聊天面板（有上下文）
✅ 复习笔记使用学习助手（基于本地内容）
```

---

## 🎓 使用技巧

### **技巧 1: 批量处理**
```
1. 翻译第一段 → 右键 → 翻译
2. 翻译第二段 → 右键 → 翻译
3. ...
4. 快速完成整篇翻译
```

### **技巧 2: 组合使用**
```
1. 右键"翻译" → 获得中文
2. 如果有疑问，选中 → 右键"解释"
3. 需要改进表达 → 右键"改写"
```

### **技巧 3: 聊天学习**
```
打开 AI 聊天：
1. 先问大概念："什么是过去完成时？"
2. 再问具体用法："had been doing 怎么用？"
3. 最后要例句："给我 5 个例句"
```

---

## 🐛 故障排查

### **问题 1: 右键菜单没有 AI 选项**
```
原因：未启用 Vault QA
解决：设置 → AI Translation → 启用 "Enable Vault QA"
```

### **问题 2: 工具栏没有 🤖 图标**
```
原因：需要重启 Obsidian
解决：Ctrl + R 重新加载或重启应用
```

### **问题 3: API 错误**
```
原因：API Key 或配置错误
解决：
1. 检查 API Key 是否正确
2. 测试 AI Connection（设置中）
3. 查看控制台错误（Ctrl + Shift + I）
```

### **问题 4: 插入位置不对**
```
原因：光标位置移动
解决：结果会插入到"选中文本的末尾"，这是正常行为
```

---

## 🎉 总结

### **新增功能完整列表**
✅ 右键菜单 - 翻译  
✅ 右键菜单 - 解释  
✅ 右键菜单 - 改写  
✅ 右键菜单 - 总结  
✅ AI 聊天面板  
✅ 工具栏图标  
✅ 快捷操作按钮  
✅ 对话上下文保持  

### **使用建议**
```
日常学习：主要用右键菜单（快速）
深入讨论：使用 AI 聊天面板（灵活）
复习笔记：使用学习助手（针对性）
```

---

**🚀 立即体验全新的 AI 辅助学习功能！**

**三种方式快速开始：**
1. 选中文本 → 右键 → 选择 AI 功能
2. 点击工具栏 🤖 图标 → 开始聊天
3. Ctrl + P → "Ask Learning Assistant" → 提问

**让 AI 成为你的英语学习伙伴！** 💪
